!function(){var e={};function o(o){var r=e.words.rows.length+1,a=e.words.rcount;$.ajax({url:"/mumu/template-wordbook-words?",data:{wordbookNo:o,templateNo:o,rstart:r,rcount:a,getWordbook:1},success:function(o){0==o.code&&(e.wordbook=o.data.wordbook,$("#title").text(e.wordbook.name),o.data.rows.length>0&&o.data.rows.forEach((o=>{e.words.rows.push(o);var r=$(".rowspad .row0").clone(!0);r.removeClass("row0"),r.addClass("no"+o.no),r.find(".word").text(o.word),o.speakUrl=o.usSpeech?o.usSpeech:o.ukSpeech?o.ukSpeech:o.speakUrl,o.phonetic=o.usPhonetic?o.usPhonetic:o.ukPhonetic?o.ukPhonetic:o.phonetic,o.phonetic?r.find(".phonetic").text("/"+o.phonetic+"/"):(r.find(".word").css("width","70%"),r.find(".phonetic").hide()),r.find(".translation").text(o.translation),$(".rowspad .row0").before(r),r.show(),e.words.map["no"+o.no]=o,r[0].data=o})))}})}function r(){$("#rollShowWordsPad").hide(),e._mp3.pause(),e.lettersound.pause(),clearTimeout(e.rollWordsInterval),clearTimeout(e.readRollWordTimeout),e.rollOpen=0}function a(t){if(e.rollOpen){if(e._mp3.pause(),e.lettersound.pause(),clearTimeout(e.rollWordsInterval),clearTimeout(e.readRollWordTimeout),0!=e.words.rows.length){var c=e.words.rows[t-1];if(c||o(e.wordbooks.selected.no),!(c=e.words.rows[t-1]))return e.rollInx=1,void a(e.rollInx);if(c.speakUrl=c.usSpeech?c.usSpeech:c.ukSpeech?c.ukSpeech:c.speakUrl,c.speakUrl||$.ajax({url:"/mumu/translate?from=1&to=2&q="+c.word,ajaxCache:!0,async:!1,success:function(e){0==e.code&&(c.speakUrl=e.data.speakUrl,c.usSpeech=e.data.usSpeech,c.ukSpeech=e.data.ukSpeech,c.usPhonetic=e.data.usPhonetic,c.ukPhonetic=e.data.ukPhonetic)}}),c.speakUrl=c.usSpeech?c.usSpeech:c.ukSpeech?c.ukSpeech:c.speakUrl,c.phonetic=c.usPhonetic?c.usPhonetic:c.ukPhonetic?c.ukPhonetic:c.phonetic,e.rollInx=t,localStorage.setItem(config.project+"-rollInx",e.rollInx),$("#rollShowWordsPad .word").text(c.word),$("#rollShowWordsPad .inx").text(t),$("#rollShowWordsPad .phonetic").text(c.phonetic?"/"+c.phonetic+"/":" "),$("#rollShowWordsPad .translation").text(c.translation||" "),e.auto&&e.rollIsSound){!function(o){var r=0;o.speakUrl?(e._mp3.muted=!1,e._mp3.src=o.speakUrl):(e._mp3.muted=!0,e._mp3.src="/file/mumu/lettersounds/a.mp3");e._mp3.onpause=function(){if(e._mp3.currentTime==e._mp3.duration)if(r>0)e.readRollWordTimeout=setTimeout((function(){e._mp3.play()}),100),r--;else{function t(){e.rollWordsInterval=setTimeout((function(){e._mp3.onpause=function(){e.rollWordsInterval=setTimeout((function(){a(e.rollInx+1)}),1e3)},e._mp3.src=o.translationVoice,e._mp3.play()}),100)}clearTimeout(e.readRollWordTimeout),clearTimeout(e.rollWordsInterval),o.translationVoice?t():$.ajax({url:"/mumu/get-read",data:{text:o.translation,lang:"zh"},success:function(e){o.translationVoice=e.data.voice,t()}})}},e._mp3.play()}(c)}}}else r()}window.page=e,e.wordbookNo=getUrlParam("wordbookNo"),e.templateNo=getUrlParam("templateNo"),e.wordbook=null,e.words={rcount:200,rows:[],inx:0,map:{},select:null},o(e.templateNo),setTimeout((function(){$("#logo").hide(),$("#index").show(),$("#play").show(),$("#title").show(),$("#goindexbtn").show()}),1e3),$(".rowspad .row0").click((function(){$(".rowspad .row").css("background-color","unset"),$(this).css("background-color","#444"),e.words.select=this.data,e.rollInx=e.words.rows.indexOf(e.words.select)+1,$("#extendSearchPad").show(),$("#extendSearchFrame").attr("src","https://cn.bing.com/images/search?ensearch=1&q="+e.words.select.word).show(),$("#extendSearchFrame1").attr("src",null).hide(),$("#extendSearchFrame2").attr("src",null).hide(),$("#extendSearchPad .bing").css("background-color","#ffffff"),$("#extendSearchPad .baidu").css("background-color","#cacaca"),$("#extendSearchPad .aliexpress").css("background-color","#cacaca")})),$("#extendSearchPad").click((function(e){this==e.target&&($("#extendSearchPad").hide(),$("#extendSearchFrame").attr("src",null).hide(),$("#extendSearchFrame1").attr("src",null).hide(),$("#extendSearchFrame2").attr("src",null).hide(),$("#extendSearchPad .bing").css("background-color","unset"),$("#extendSearchPad .baidu").css("background-color","unset"),$("#extendSearchPad .ebay").css("background-color","unset"))})),$("#extendSearchPad .bing").click((function(e){$("#extendSearchFrame").show(),$("#extendSearchFrame1").hide(),$("#extendSearchFrame2").hide(),$("#extendSearchPad .bing").css("background-color","#ffffff"),$("#extendSearchPad .baidu").css("background-color","#cacaca"),$("#extendSearchPad .aliexpress").css("background-color","#cacaca")})),$("#extendSearchPad .baidu").click((function(o){$("#extendSearchFrame").hide(),$("#extendSearchFrame1").show(),$("#extendSearchFrame2").hide(),$("#extendSearchPad .bing").css("background-color","#cacaca"),$("#extendSearchPad .baidu").css("background-color","#ffffff"),$("#extendSearchPad .aliexpress").css("background-color","#cacaca"),$("#extendSearchFrame1").attr("src")||$("#extendSearchFrame1").attr("src","https://m.baidu.com/s?word=英文"+e.words.select.word)})),$("#extendSearchPad .aliexpress").click((function(o){$("#extendSearchFrame").hide(),$("#extendSearchFrame1").hide(),$("#extendSearchFrame2").show(),$("#extendSearchPad .bing").css("background-color","#cacaca"),$("#extendSearchPad .baidu").css("background-color","#cacaca"),$("#extendSearchPad .aliexpress").css("background-color","#ffffff"),$("#extendSearchFrame2").attr("src")||$("#extendSearchFrame2").attr("src","https://m.aliexpress.com/wholesale/"+e.words.select.word+".html?osf=direct")})),$(".coverTargetTextBtn").click((function(){"hidden"==$(".word").css("visibility")?$(".word").css("visibility","visible"):$(".word").css("visibility","hidden")})),$(".coverPhoneticTextBtn").click((function(){"hidden"==$(".phonetic").css("visibility")?$(".phonetic").css("visibility","visible"):$(".phonetic").css("visibility","hidden")})),$(".coverMainTextBtn").click((function(){"hidden"==$(".translation").css("visibility")?$(".translation").css("visibility","visible"):$(".translation").css("visibility","hidden")})),$("#goindexbtn").click((function(){location.replace("./")})),$("#play").click((function(){e.rollOpen=1,$("#rollShowWordsPad").show(),$("#rollShowWordsPad .stop").hide(),$("#rollShowWordsPad .start").show(),e.rollIsSound=0,e.auto=0,e.rollInx=e.rollInx?e.rollInx:1,a(e.rollInx)})),$("#rollShowWordsPad").click((function(e){this==e.target&&r()})),$("#rollShowWordsPad .prev").click((function(o){a(e.rollInx-1)})),$("#rollShowWordsPad .next").click((function(o){a(e.rollInx+1)})),$("#rollShowWordsPad .restart").click((function(e){a(1)})),$("#rollShowWordsPad .stop").click((function(o){e._mp3.pause(),e.lettersound.pause(),clearTimeout(e.rollWordsInterval),clearTimeout(e.readRollWordTimeout),$("#rollShowWordsPad .stop").hide(),$("#rollShowWordsPad .start").show(),e.rollIsSound=0,e.auto=0})),$("#rollShowWordsPad .start").click((function(o){var r;e.rollIsSound=1,e.auto=1,r=e.rollInx,$("#rollShowWordsPad .stop").show(),$("#rollShowWordsPad .start").hide(),e.rollIsSound=1,e.auto=1,a(r=r||1)})),$("#startRollBtn").click((function(){e.rollOpen=1,$("#rollShowWordsPad").show(),$("#rollShowWordsPad .stop").hide(),$("#rollShowWordsPad .start").show(),e.rollIsSound=0,e.auto=0,e.rollInx=e.rollInx?e.rollInx:1,a(e.rollInx)})),$("#rollShowWordsPad .word").click((function(){var o=e.words.rows[e.rollInx-1];translatee(o.word),loadRelatedWords(o.word),r()})),e._mp3=document.createElement("video"),e.lettersound=document.createElement("video"),is_weixn()&&($.post("/mumu/wxjsapiticket",(e=>{$.post("/mumu/wxsign",{ticket:e.data.ticket,url:location.href},(e=>{wx.config({debug:!1,appId:e.data.appid,timestamp:e.data.timestamp,nonceStr:e.data.nonceStr,signature:e.data.signature,jsApiList:["updateAppMessageShareData","updateTimelineShareData"]})}))})),e.shareLink=location.origin+"/mumu/wordbook.html?wordbookNo="+e.wordbookNo+"&templateNo="+e.templateNo,wx.ready((function(){wx.updateAppMessageShareData({title:e.wordbook.name,desc:"单词本",link:e.shareLink,imgUrl:location.origin+"/mumu/favicon.ico",success:function(){}}),wx.updateTimelineShareData({title:e.wordbook.name+"\n单词本",link:e.shareLink,imgUrl:location.origin+"/mumu/favicon.ico",success:function(){}})})))}();