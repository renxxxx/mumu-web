!function(){var o={};function e(e){var t=o.words.rows.length+1,r=o.words.rcount;$.ajax({url:"/mumu/template-wordbook-words?",data:{wordbookNo:e,templateNo:e,rstart:t,rcount:r,getWordbook:1},success:function(e){0==e.code&&(o.wordbook=e.data.wordbook,$("#title").text(o.wordbook.name),e.data.rows.length>0&&e.data.rows.forEach((e=>{o.words.rows.push(e);var t=$(".rowspad .row0").clone(!0);t.removeClass("row0"),t.addClass("no"+e.no),t.find(".word").text(e.word),e.speakUrl=e.usSpeech?e.usSpeech:e.ukSpeech?e.ukSpeech:e.speakUrl,e.phonetic=e.usPhonetic?e.usPhonetic:e.ukPhonetic?e.ukPhonetic:e.phonetic,e.phonetic?t.find(".phonetic").text("/"+e.phonetic+"/"):(t.find(".word").css("width","66.666666%"),t.find(".phonetic").hide()),t.find(".translation").text(e.translation),$(".rowspad .row0").before(t),t.show(),o.words.map["no"+e.no]=e,t[0].data=e})))}})}function t(){$("#rollShowWordsPad").hide(),o._mp3.pause(),o.lettersound.pause(),clearTimeout(o.rollWordsInterval),clearTimeout(o.readRollWordTimeout),o.rollOpen=0}function r(a){if(o.rollOpen){if(o._mp3.pause(),o.lettersound.pause(),clearTimeout(o.rollWordsInterval),clearTimeout(o.readRollWordTimeout),0!=o.words.rows.length){var n=o.words.rows[a-1];if(n||e(o.wordbooks.selected.no),!(n=o.words.rows[a-1]))return o.rollInx=1,void r(o.rollInx);if(n.speakUrl=n.usSpeech?n.usSpeech:n.ukSpeech?n.ukSpeech:n.speakUrl,n.speakUrl||$.ajax({url:"/mumu/translate?from=1&to=2&q="+n.word,ajaxCache:!0,async:!1,success:function(o){0==o.code&&(n.speakUrl=o.data.speakUrl,n.usSpeech=o.data.usSpeech,n.ukSpeech=o.data.ukSpeech,n.usPhonetic=o.data.usPhonetic,n.ukPhonetic=o.data.ukPhonetic)}}),n.speakUrl=n.usSpeech?n.usSpeech:n.ukSpeech?n.ukSpeech:n.speakUrl,n.phonetic=n.usPhonetic?n.usPhonetic:n.ukPhonetic?n.ukPhonetic:n.phonetic,o.rollInx=a,localStorage.setItem(config.project+"-rollInx",o.rollInx),$("#rollShowWordsPad .word").text(n.word),$("#rollShowWordsPad .inx").text(a),$("#rollShowWordsPad .phonetic").text(n.phonetic?"/"+n.phonetic+"/":" "),$("#rollShowWordsPad .translation").text(n.translation||" "),o.auto&&o.rollIsSound){!function(e){var t=0;e.speakUrl?(o._mp3.muted=!1,o._mp3.src=e.speakUrl):(o._mp3.muted=!0,o._mp3.src="/file/mumu/lettersounds/a.mp3");o._mp3.onpause=function(){if(o._mp3.currentTime==o._mp3.duration)if(t>0)o.readRollWordTimeout=setTimeout((function(){o._mp3.play()}),100),t--;else{function a(){o.rollWordsInterval=setTimeout((function(){o._mp3.onpause=function(){o.rollWordsInterval=setTimeout((function(){r(o.rollInx+1)}),1e3)},o._mp3.src=e.translationVoice,o._mp3.play()}),100)}clearTimeout(o.readRollWordTimeout),clearTimeout(o.rollWordsInterval),e.translationVoice?a():$.ajax({url:"/mumu/get-read",data:{text:e.translation,lang:"zh"},success:function(o){e.translationVoice=o.data.voice,a()}})}},o._mp3.play()}(n)}}}else t()}window.page=o,o.wordbookNo=getUrlParam("wordbookNo"),o.templateNo=getUrlParam("templateNo"),o.wordbook=null,o.words={rcount:200,rows:[],inx:0,map:{},select:null},e(o.templateNo),setTimeout((function(){$("#logo").hide(),$("#index").show(),$("#play").show(),$("#title").show(),$("#goindexbtn").show()}),1e3),$(".rowspad .row0").click((function(){o.words.select=this.data,o.rollInx=o.words.rows.indexOf(o.words.select)+1,$("#extendSearchPad").show(),$("#extendSearchFrame").attr("src","https://cn.bing.com/images/search?ensearch=1&q="+o.words.select.word).show(),$("#extendSearchFrame1").attr("src",null).hide(),$("#extendSearchPad .bing").css("background-color","#ffffff"),$("#extendSearchPad .baidu").css("background-color","#cacaca")})),$("#extendSearchPad").click((function(o){this==o.target&&($("#extendSearchPad").hide(),$("#extendSearchFrame").attr("src",null).hide(),$("#extendSearchFrame1").attr("src",null).hide(),$("#extendSearchPad .bing").css("background-color","unset"),$("#extendSearchPad .baidu").css("background-color","unset"))})),$("#extendSearchPad .baidu").click((function(e){$("#extendSearchFrame").hide(),$("#extendSearchFrame1").show(),$("#extendSearchPad .bing").css("background-color","#cacaca"),$("#extendSearchPad .baidu").css("background-color","#ffffff"),$("#extendSearchFrame1").attr("src")||$("#extendSearchFrame1").attr("src","https://m.baidu.com/s?word=英文"+o.words.select.word)})),$("#extendSearchPad .bing").click((function(o){$("#extendSearchFrame").show(),$("#extendSearchFrame1").hide(),$("#extendSearchPad .bing").css("background-color","#ffffff"),$("#extendSearchPad .baidu").css("background-color","#cacaca")})),$(".coverTargetTextBtn").click((function(){"hidden"==$(".word").css("visibility")?$(".word").css("visibility","visible"):$(".word").css("visibility","hidden")})),$(".coverPhoneticTextBtn").click((function(){"hidden"==$(".phonetic").css("visibility")?$(".phonetic").css("visibility","visible"):$(".phonetic").css("visibility","hidden")})),$(".coverMainTextBtn").click((function(){"hidden"==$(".translation").css("visibility")?$(".translation").css("visibility","visible"):$(".translation").css("visibility","hidden")})),$("#goindexbtn").click((function(){location.replace("./")})),$("#play").click((function(){o.rollOpen=1,$("#rollShowWordsPad").show(),$("#rollShowWordsPad .stop").hide(),$("#rollShowWordsPad .start").show(),o.rollIsSound=0,o.auto=0,o.rollInx=o.rollInx?o.rollInx:1,r(o.rollInx)})),$("#rollShowWordsPad").click((function(o){this==o.target&&t()})),$("#rollShowWordsPad .prev").click((function(e){r(o.rollInx-1)})),$("#rollShowWordsPad .next").click((function(e){r(o.rollInx+1)})),$("#rollShowWordsPad .restart").click((function(o){r(1)})),$("#rollShowWordsPad .stop").click((function(e){o._mp3.pause(),o.lettersound.pause(),clearTimeout(o.rollWordsInterval),clearTimeout(o.readRollWordTimeout),$("#rollShowWordsPad .stop").hide(),$("#rollShowWordsPad .start").show(),o.rollIsSound=0,o.auto=0})),$("#rollShowWordsPad .start").click((function(e){var t;o.rollIsSound=1,o.auto=1,t=o.rollInx,$("#rollShowWordsPad .stop").show(),$("#rollShowWordsPad .start").hide(),o.rollIsSound=1,o.auto=1,r(t=t||1)})),$("#startRollBtn").click((function(){o.rollOpen=1,$("#rollShowWordsPad").show(),$("#rollShowWordsPad .stop").hide(),$("#rollShowWordsPad .start").show(),o.rollIsSound=0,o.auto=0,o.rollInx=o.rollInx?o.rollInx:1,r(o.rollInx)})),$("#rollShowWordsPad .word").click((function(){var e=o.words.rows[o.rollInx-1];translatee(e.word),loadRelatedWords(e.word),t()})),o._mp3=document.createElement("video"),o.lettersound=document.createElement("video"),is_weixn()&&($.post("/mumu/wxjsapiticket",(o=>{$.post("/mumu/wxsign",{ticket:o.data.ticket,url:location.href},(o=>{wx.config({debug:!1,appId:o.data.appid,timestamp:o.data.timestamp,nonceStr:o.data.nonceStr,signature:o.data.signature,jsApiList:["updateAppMessageShareData","updateTimelineShareData"]})}))})),o.shareLink=location.origin+"/mumu/wordbook.html?wordbookNo="+o.wordbookNo,wx.ready((function(){wx.updateAppMessageShareData({title:o.wordbook.name+" - 单词本",desc:"幕幕短视频",link:o.shareLink,imgUrl:location.origin+"/mumu/favicon.ico",success:function(){}}),wx.updateTimelineShareData({title:o.wordbook.name+" - 单词本\n幕幕短视频",link:o.shareLink,imgUrl:location.origin+"/mumu/favicon.ico",success:function(){}})})))}();