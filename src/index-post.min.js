!function(){var e={};window.page=e,log.debugon=0,$("#video")[0].crossOrigin="anonymous",$("#finger,gear").animate({left:"+=150px"},2e3,(function(){$("#finger").animate({left:"-=300px"},2e3,(()=>{$("#finger").fadeOut(500)}))})),$("#gear").animate({left:"+=150px"},2e3,(function(){$("#gear").animate({left:"-=300px"},2e3)})),document.addEventListener("WeixinJSBridgeReady",(function(){$("#video")[0].play()}),!1);var t,n,i=[],s=window.location.search.substring(1).split("&")[0].split("=")[1],r=null;s&&$.ajax({url:"/mumu/video?",type:"get",data:"videoNo="+s,async:!1,success:function(e){r=e.data.video}});var o=[],a=-1;o&&0!=o.length||$.ajax({url:"/mumu/explore-videos?",type:"get",data:"shortvideo=1&kw=&pageSize=30",async:!1,success:function(e){o.push(...e.data.videos),localStorage.setItem("videos",JSON.stringify(o))}}),r&&o.unshift(r);var c=localStorage.getItem("currentTime-"+n),u=parseInt(localStorage.getItem("currentIndex-"+n)),l=JSON.parse(localStorage.getItem("currentCaption-"+n)),d=l,m=0,g=0,p=0,h={subtitles:"",monitor:"",subtitlesList:[],current:l,currentIndex:u};e.en=h;var f=[];y=y;var b=$("#video")[0];function v(){Y(),o[a+1]||$.ajax({url:"/mumu/explore-videos?",type:"get",data:"shortvideo=1&kw=&pageSize=30",async:!1,success:function(e){e.data.videos.length>0&&(o.push(...e.data.videos),localStorage.setItem("videos",JSON.stringify(o)))}}),o[a+1]&&(a++,n=o[a].no,t=o[a],localStorage.setItem("videosIndex",a),w(t))}function w(e){t=e,function(){if(localStorage.getItem("translateed"))$("#video").css("top","0"),$("#video").attr("autoplay",!0),$("#video").attr("src",t.url),setTimeout((function(){$("#video")[0].muted=!1}),500);else{$("#hintssec").text(3),Y(),$("#video").css("top","-1000px"),$("#hints").css("height",$("#video").css("height")).show(),setTimeout((function(){$("#hints").fadeOut(1e3,(function(){$("#video").css("top","0"),$("#video").attr("src",t.url),setTimeout((function(){$("#video")[0].muted=!1}),500)}))}),3e3);var e=setInterval((function(){var t=$("#hintssec").text()-1;t<1?clearInterval(e):$("#hintssec").text(t)}),1e3)}}(),$.ajax({url:t.captionUrl,type:"get",async:!1,success:function(e){!function(e){log.debug("getEnSubtitles: "+ ++m),h.subtitlesList=[];let n=[];n=e.split(/[(\r\n)\r\n]+/),n.forEach(((e,t)=>{if(e||n.splice(t,1),new RegExp(/^(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d/).test(e)){var i=n[t+2],s=n[t+1];if(i.indexOf("{\\pos")>=0||s.indexOf("{\\pos")>=0)return;h.subtitlesList.push({startTime:O(e.split(" --\x3e ")[0].replace(",",".")),endTime:O(e.split(" --\x3e ")[1].replace(",",".")),chValue:s,enValue:i})}}));for(let e=0;e<h.subtitlesList.length;e++){e;const t=h.subtitlesList[e],n=h.subtitlesList[e+1];e<h.subtitlesList.length-2&&n.startTime-t.endTime>1e3&&h.subtitlesList.splice(e+1,0,{startTime:parseInt(t.endTime)+1e3,endTime:n.startTime,chValue:"",enValue:""})}var i=h.subtitlesList[0];i&&i.startTime>0&&h.subtitlesList.splice(0,0,{startTime:0,endTime:i.startTime,chValue:"",enValue:""});var s=h.subtitlesList[h.subtitlesList.length-1];s&&h.subtitlesList.push({startTime:parseInt(s.endTime)+1e3,endTime:1e3*t.duration,chValue:"",enValue:""});h.currentIndex>=0?(h.current=h.subtitlesList[h.currentIndex],y(h.current)):y(h.subtitlesList[0])}(e)}}),setTimeout((function(){var e=JSON.parse(localStorage.getItem("historyvideos"));e||(e=[]),e.unshift(t),localStorage.setItem("historyvideos",JSON.stringify(e))}),5e3)}function T(){log.debug("onCanPlay: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5))),g||c&&($("#video")[0].currentTime=c,log.debug("set lct: "+c+" ct: "+$("#video")[0].currentTime),$("#video")[0].currentTime>=c&&(g=1))}function x(){!function(){if(!p){if(0==c)return void(p=1);c&&($("#video")[0].currentTime=c,log.debug("set lct: "+c+" ct: "+$("#video")[0].currentTime),$("#video")[0].currentTime>=c&&(p=1))}}(),b.paused&&k(1e3*b.currentTime)}function k(e){if($("#loading").hide(),localStorage.setItem("durationsec-"+n,$("#video")[0].duration),localStorage.setItem("currentTime-"+n,$("#video")[0].currentTime),d){if(!(d.startTime<e))return;d=null}if(!(h.current&&h.current.startTime<=e&&e<h.current.endTime)){var t=h.subtitlesList[h.currentIndex+1];return t&&t.startTime<=e&&e<t.endTime?(log.debug("next "),h.current=t,h.currentIndex++,void y(t)):t&&e<t.startTime&&(!h.current||e>h.current.endTime)?(log.debug("before next"),void log.debug("next: st: "+t.startTime+" currinx: "+h.currentIndex)):void $(h.subtitlesList).each((function(t,n){if(n.startTime<=e&&e<n.endTime){debugger;return log.debug("search all "),h.current=n,h.currentIndex=t,void y(n)}}))}}function y(e){if(!e)return;log.debug("setline: ct: "+$("#video")[0].currentTime+" st: "+e.startTime+" et: "+e.endTime+" "+e.enValue.substr(0,5)),localStorage.setItem("currentCaption-"+n,JSON.stringify(e)),localStorage.setItem("currentIndex-"+n,h.currentIndex);let t=e.enValue.split(" ");$("#zh_subtitles").html(""),h.currentwords=t;for(let e=0;e<t.length;e++)if("\\n"!=t[e]){var i=t[e].split("\\n");if(i[0]){var s=$('<span style="border-bottom:2px solid #ffffff;;user-select: none;display: inline-block;cursor: pointer;font-weight: 900;font-size: 18px;padding-left:3px;padding-right:3px;" index="'+e+'" class="font span'+e+'">'+i[0]+"</span>");s.bind("click",(function(){Y(),M(e+1)})).bind("mouseout",(function(){$(this).css("border-bottom","2px solid #ffffff")})).bind("mouseover",(function(){$(this).css("border-bottom","2px solid black")})),$("#zh_subtitles").append(s)}i[1]&&t.splice(e+1,0,"\\n",i[1]),i[2]&&t.splice(e+3,0,"\\n",i[2]),i[3]&&t.splice(e+5,0,"\\n",i[3])}else $("#zh_subtitles").append("<br/>");$(".dialog").css({display:"none"}),$(".dialogTitle #kw").html(""),j=0,$(".dialog").css({display:"none"}),$(".dialogTitle #kw").html(""),$("#summtrans").hide(),$("#wordsframe").hide(),$("#word-in").val(""),$("#video").css("top","0px")}function I(){if(h.currentIndex>0){var e=h.currentIndex,t=h.subtitlesList[--e];t&&(t.enValue||(t=h.subtitlesList[--e])),t&&(h.currentIndex=e,h.current=t,d=t,c=t.startTime/1e3,$("#video")[0].currentTime=t.startTime/1e3,log.debug("set ct: "+t.startTime/1e3+" ct: "+$("#video")[0].currentTime),y(t),j=0,N(),$(".dialog").css({display:"none"}),$(".dialogTitle #kw").html(""))}}function _(){var e=h.currentIndex,t=h.current;t&&(t.enValue||(t=h.subtitlesList[--e]),t&&(h.currentIndex=e,h.current=t,$("#video")[0].currentTime=t.startTime/1e3,d=t,c=t.startTime/1e3,log.debug("set ct: "+t.startTime/1e3+" ct: "+$("#video")[0].currentTime),y(t),j=0,N(),$(".dialog").css({display:"none"}),$(".dialogTitle #kw").html("")))}function S(){var e=h.currentIndex,t=h.subtitlesList[++e];t&&(t.enValue||(t=h.subtitlesList[++e]),t&&(h.currentIndex=e,h.current=t,d=t,c=t.startTime/1e3,$("#video")[0].currentTime=t.startTime/1e3,log.debug("set ct: "+t.startTime/1e3+" ct: "+$("#video")[0].currentTime),y(t),j=0,N(),$(".dialog").css({display:"none"}),$(".dialogTitle #kw").html("")))}function X(e){log.debug(e+3),$("#summrest").hide();var n=localStorage.getItem("translateed");n=parseInt(n?++n:1),localStorage.setItem("translateed",n),e=e.replace(/^(,|\.|\?|!|\[|\]\(|\))+/,"").replace(/(,|\.|\?|!|\[|\]\(|\))+$/,""),$("#summtrans").show(),$("#summtrans-word").text(e),$("#word-in").val(e),clearTimeout(window.timeoutdo1),window.timeoutdo1=setTimeout((function(){if($("#favor").attr("word",e),window.aaa=setTimeout((function(){$("#summtrans-phonetic").hide(),$("#summtrans-speak").hide(),$("#summtrans-value").hide()}),500),null==e||null==e||!e.toString().trim())return $("#summtrans-phonetic").hide(),$("#summtrans-speak").hide(),void $("#summtrans-value").hide();$.ajax({url:"/mumu/translate?from="+t.language+"&to=2&q="+e,type:"get",async:!0,success:function(e){clearTimeout(window.aaa),e.data.phonetic?$("#summtrans-phonetic").text("/"+e.data.phonetic+"/").show():$("#summtrans-phonetic").hide(),e.data.speakUrl?$("#summtrans-speak").attr("play-url",e.data.speakUrl).show():$("#summtrans-speak").hide(),$("#summtrans-vv").html("").scrollTop(0),e.data.translations&&$(e.data.translations).each((function(e,t){$("#summtrans-vv").append(`<div>${U(t)}</div>`)})),e.data.webTranslations&&($("#summtrans-vv").append('<div style="margin-top:10px;">网络释义: </div>'),$(e.data.webTranslations).each((function(e,t){$("#summtrans-vv").append(`<div>${U(t)}</div>`)}))),$(".lightkeytrans").bind("click",(function(){X(this.innerText)})),$("#wordsframe").hide(),$("#summrest").show(),$("#summtrans-vv").show(),$("#summtrans-value").show(),$("#summtrans").show(),$("#video").css("top","-1000px")}})}),200)}function Y(){log.debug("pauseVideo()"),$("#video")[0].pause()}function z(){log.debug("playVideo()"),$("#video")[0].play(),clearTimeout(window.timeoutdo1)}function V(){log.debug("onpause: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5))),clearInterval(h.monitor),$(".stopFn").css({display:"none"}),$(".startFn").css({display:"inline"}),$("#video")[0].currentTime==$("#video")[0].duration&&setTimeout((function(){v()}),1e3),e.dovideoshadow&&$("#videoshasow").is(":hidden")&&(clearTimeout(e.timeout11),e.timeout11=setTimeout((function(){var t=videocapture($("#video")[0]);$("#videoshasowimg").attr("src",t.src),$("#videoshasow").show(),$("#video").css("top","-1000px"),clearTimeout(e.timeout11)}),300))}l&&y(l),v(),$("#historyword_template").bind("click",(function(t){log.info("$(#historyword_template).click "+$(this).attr("data")),e.dovideoshadow=1,Y(),X(this.innerText)})),function(){var e=localStorage.getItem("historywords");e&&(i=JSON.parse(e));for(let e=0;e<i.length;e++){var t=i[e];t=t.replace(/^(,|\.|\?|!|\[|\]\(|\))+/,"").replace(/(,|\.|\?|!|\[|\]\(|\))+$/,"");var n=$("#historyword_template").clone(!0);n.attr("id","historyword-"+t.replace(/[^\w]/g,"")),n.attr("data",t),n.text(t),n.css("display","inline-block"),n.show(),$("#historywordspad").append(n)}}(),$(".yibiao").on("click","span svg",(function(){log.info("$(.yibiao).click"),new Audio($(this).attr("playsrc")).play()})),$("#favor").click((function(){log.info("#favor.click");var e=$(this).attr("word");/.*[\u4e00-\u9fa5]+.*$/.test(e)||$(this).attr("word").split(" ").length>3||(function(e){var t=i.indexOf(e);t>-1&&i.splice(t,1);$("#historyword-"+e.replace(/[^\w]/g,"")).remove()}(e),function(e){e=e.replace(/^(,|\.|\?|!|\[|\]\(|\))+/,"").replace(/(,|\.|\?|!|\[|\]\(|\))+$/,"");var t=(i=i||[]).indexOf(e);t>-1&&i.splice(t,1);i.unshift(e);var n=$("#historyword_template").clone(!0);n.attr("id","historyword-"+e.replace(/[^\w]/g,"")),n.attr("data",e),n.text(e),n.css("display","inline-block"),$("#historywordspad").prepend(n),localStorage.setItem("historywords",JSON.stringify(i))}(e))})),e.dovideoshadow=0;var L=null;function D(){if(!h.current||!h.current.chValue)return;L=$("#video")[0].paused;$("#video")[0].currentTime;$(".chDialog").css("display","block"),$(".chDialog div").html(h.current.chValue.replace(/\\n/g,"<br/>")),Y()}function N(){$(".chDialog").css("display","none"),L?Y():z()}function O(e){let t=e.split(":"),n=0;return t.forEach(((e,t)=>{switch(t){case 0:n+=60*parseFloat(e)*60*1e3;break;case 1:n+=60*parseFloat(e)*1e3;break;case 2:n+=1e3*parseFloat(e);break}})),n}function C(t){log.debug(t),e.dovideoshadow=1,Y();let n=$("#zh_subtitles").width()+$("#zh_subtitles").offset().left-5,i=$("#zh_subtitles").height()+$("#zh_subtitles").offset().top-5;if(f=[],$("#zh_subtitles span").css({background:"transparent",color:"black"}),ele=document.elementFromPoint(t.pageX,t.pageY),!$(ele).hasClass("font"))return;let s=t.clientX||t.pageX,r=t.clientY||t.pageY;n-5>s&&s>$("#zh_subtitles").offset().left+5&&$("#zh_subtitles").offset().top+5<r&&r<i-5&&ele.className.lastIndexOf("font span ")<0&&" "!=ele.innerHTML&&(f.push({class:ele.className,value:ele.innerHTML}),$("."+ele.className.split(" ")[1]).css({background:"#d2cbcb",color:"black"}))}function E(e){if(ele=document.elementFromPoint(e.pageX,e.pageY),!$(ele).hasClass("font"))return;let t=e.clientX||e.pageX,n=e.clientY||e.pageY,i=$("#zh_subtitles").width()+$("#zh_subtitles").offset().left,s=$("#zh_subtitles").height()+$("#zh_subtitles").offset().top;if(i-5>t&&t>$("#zh_subtitles").offset().left+5&&$("#zh_subtitles").offset().top+5<n&&n<s-5&&ele.className.lastIndexOf("font span ")<0){let e=!0;if(f.findIndex((function(t,n){t.class==ele.className&&(e=!1)})),e&&" "!=ele.innerHTML)if(f.length){let e=parseInt(f[f.length-1].class.replace("font span","")),t=parseInt(ele.className.replace("font span",""));if(log.debug(t-e),t==e+1)f.push({class:ele.className,value:ele.innerHTML}),$("."+ele.className.split(" ")[1]).css({background:"#d2cbcb",color:"black"});else if(t>e+1)for(let n=e;n<t;n++)$(".span"+n),f.push({class:$(".span"+n).attr("class"),value:$(".span"+n).html()}),$(".span"+n).css({background:"#d2cbcb",color:"black"});else for(let n=t;n<e;n++)$(".span"+n),f.push({class:$(".span"+n).attr("class"),value:$(".span"+n).html()}),$(".span"+n).css({background:"#d2cbcb",color:"black"})}else f.push({class:ele.className,value:ele.innerHTML}),$("."+ele.className.split(" ")[1]).css({background:"#d2cbcb",color:"black"})}}function F(e){ele=document.elementFromPoint(e.pageX,e.pageY);for(let e=0;e<f.length-1;e++)for(let t=0;t<f.length-e-1;t++)if(parseInt(f[t].class.replace("font span",""))>parseInt(f[t+1].class.replace("font span",""))){let e=f[t];f[t]=f[t+1],f[t+1]=e}let t="";$(f).each((function(e,n){e>0?t+=" "+n.value.replace(/^(,|\.|\?|!)+/,"").replace(/(,|\.|\?|!)+$/,""):t=n.value.replace(/^(,|\.|\?|!)+/,"").replace(/(,|\.|\?|!)+$/,"")})),t?(t,X(t)):"",$(".searchClass").blur()}$("#zh_subtitles").mousedown((e=>{log.info("#zh_subtitles.mousedown"),$(e.target).hasClass("font")&&(moveStata=!0,_coordinates={clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY},C(_coordinates),$("#zh_subtitles").mousemove((e=>{$(e.target).hasClass("font")&&moveStata&&(_coordinates={clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY},E(_coordinates))})).mouseup((function(e){log.info("#zh_subtitles.mouseup"),$(e.target).hasClass("font")&&(moveStata=!1,_coordinates={clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY},F(_coordinates),$("#zh_subtitles").unbind("mousemove").unbind("mouseup"))})))}));var J,j=0,P=[];function M(t){(j=t,$(".font").css({background:"transparent"}),$(".font.span"+(j-1)).css({background:"#d2cbcb"}),e.dovideoshadow=1,Y(),$("#summtrans-word").show(),j>0)&&($("#wordsframe").hide(),X(h.currentwords[j-1]))}function B(){isPc()?($("#gearframe1").hide(),$("#pcrecommand").text("控制键(a,s,d,space) 翻译键(q,w,e,enter)")):($("#gearframe1").show(),$("#pcrecommand").text("PC端操作更方便"))}function A(){document.activeElement==$("#word-in")[0]?($("#wordsframe").hide(),X($("#word-in").val()),$("#word-in").val()||($("#summtrans").hide(),$("#wordsframe").hide(),$("#video").css("top",0))):($("#summtrans").hide(),$("#wordsframe").show(),$("#word-in").focus(),$("#word-in").trigger("input"),e.dovideoshadow=1,Y())}document.onkeydown=function(e){var t=e||window.e,n=t.keyCode||t.which,i=(P=[]).pop();switch(null!=i&&null!=i&&P.push(i),n!=i&&P.push(n),log.debug(P+" down"),P.join()){case"27":$("#summtrans").hide(),$("#summtrans-word").text(""),$("#summtrans-phonetic").text("").hide(),$("#summtrans-speak").attr("play-url","").hide(),$("#summtrans-value").hide(),$("#summtrans-vv").text(""),$("#wordsframe").hide(),$("#word-in").val(""),$("#words .word").remove(),$("#video").css("top",0);break;case"32":if(document.activeElement==$("#word-in")[0])return;$("#video")[0].paused?(N(),z()):Y();break;case"13":A();break;case"97":case"65":if(document.activeElement==$("#word-in")[0])return;I();break;case"115":case"83":if(document.activeElement==$("#word-in")[0])return;_();break;case"119":case"87":if(document.activeElement==$("#word-in")[0])return;$(".chDialog").is(":hidden")?D():N();break;case"100":case"68":if(document.activeElement==$("#word-in")[0])return;S();break;case"113":case"81":if(document.activeElement==$("#word-in")[0])return;j<=1?j=h.currentwords.length:j--,M(j);break;case"101":case"69":if(document.activeElement==$("#word-in")[0])return;++j>h.currentwords.length&&(j=1),M(j);break}},document.onkeyup=function(e){log.debug(P+" up"),P.pop()},document.onfocus=function(){log.debug("document.blur()"),P=[]},window.onbeforeunload=function(){log.debug("onbeforeunload"),navigator.sendBeacon("/mumu/page-out"),log.flush()},document.addEventListener("touchend",(function(e){var t=(new Date).getTime();t-J<=300&&e.preventDefault(),J=t}),!1),B(),$(document.body).bind("resize",(function(){B()})),$.get("/mumu/wxjsapiticket",(e=>{$.get("/mumu/wxsign",{ticket:e.data.ticket,url:location.href},(e=>{log.debug(JSON.stringify(e)),wx.config({debug:!1,appId:e.data.appid,timestamp:e.data.timestamp,nonceStr:e.data.nonceStr,signature:e.data.signature,jsApiList:["updateAppMessageShareData","updateTimelineShareData"]})}))}));var H=location.origin+"/mumu/index.html?videoNo="+n;function U(e){if(!e)return e;var t=e.match(/(\w*)\s*?(的过去|的现在|的复数|的第三|的ing)/);return t?e=e.replace(t[1],`<span class="lightkeytrans" style="text-decoration: underline;cursor:pointer;">${t[1]}</span>`):e}wx.ready((function(){wx.updateAppMessageShareData({title:t.name,desc:"幕幕 - 英语练习",link:H,imgUrl:location.origin+"/mumu/favicon.ico",success:function(){}}),wx.updateTimelineShareData({title:t.name+"\n幕幕 - 英语练习",link:H,imgUrl:location.origin+"/mumu/favicon.ico",success:function(){}})})),$("#video").bind("play",(function(){log.debug("onplay: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5))),e.dovideoshadow=0,clearTimeout(e.timeout11),$(".dialog").hide(),$("#summtrans").hide(),$("#summtrans-word").text(""),$("#wordsframe").hide(),$("#word-in").val(""),$("#summtrans-value").hide(),$("#summtrans-vv").text(""),$("#summtrans-phonetic").text("").hide(""),$("#summtrans-speak").attr("play-src","").hide(""),$("#video").css("top","0px"),clearInterval(h.monitor),h.monitor=setInterval((function(){k(1e3*b.currentTime)}),10),j=0,"",$("#zh_subtitles span").css({background:"transparent",color:"black"}),$(".startFn").css({display:"none"}),$(".stopFn").css({display:"inline"}),$(".dialog").css({display:"none"}),$(".dialogTitle #kw").html(""),$(".searchClass").val(""),$(".yibiao").html(""),$(".fanyi").html(""),$("#videoshasow").hide()})).bind("pause",(function(){V()})).bind("mouseover",(function(){$("#video").attr("controls",!0)})).bind("mouseout",(function(){$("#video").attr("controls",!1)})).bind("canplay",(function(){T()})).bind("durationchange",(function(){log.debug("ondurationchange: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5)))})).bind("loadeddata",(function(){log.debug("onloadeddata: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5)))})).bind("loadstart",(function(){log.debug("onloadstart: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5)))})).bind("playing",(function(){log.debug("onplaying: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5)))})).bind("progress",(function(){log.debug("onprogress: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5)))})).bind("readystatechange",(function(){log.debug("onreadystatechange: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5)))})).bind("suspend",(function(){log.debug("onsuspend: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5)))})).bind("timeupdate",(function(){x()})).bind("waiting",(function(){log.debug("onwaiting: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5)))})).bind("click",(function(){log.debug("onclick: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5))),$("#video").attr("controls",!0)})).bind("loadedmetadata",(function(){log.debug("onloadedmetadata: "+ ++m),log.debug(" ct: "+$("#video")[0].currentTime+" st: "+(h.current&&h.current.startTime)+" et: "+(h.current&&h.current.endTime)+" "+(h.current&&h.current.enValue.substr(0,5)))})).bind("touchend",(function(){$("#video").attr("controls",!0)})).bind("focus",(function(){$("#video").attr("controls",!0)})).bind("blur",(function(){$("#video").attr("controls",!1)})),$("#summtrans-word").bind("click",(function(){log.info("#summtrans-word.click"),$("#summtrans").hide(),$("#wordsframe").show(),$("#word-in").val(this.innerText).focus(),$("#word-in").trigger("input")})),$("#summtrans-speak").bind("click",(function(){log.info("#summtrans-speak.click"),this.audio||(this.audio=new Audio),this.audio.src=$(this).attr("play-url"),this.audio.play()})),$("#wordtempl").bind("click",(function(){log.info("#wordtempl.click"),$("#wordsframe").hide(),$("#word-in").val(""),$("#words .word").remove(),X(this.item.q)})),$("#word-in").bind("input",(function(){log.info("#word-in.input");var e=this,n=this.value;n?$.ajax({url:"/mumu/words",method:"get",data:{kw:n,start:1,pageSize:10,from:t.language,to:2},success:function(t){if(e.value==n){$("#words .word").remove();var i=t.data.words;$(i).each(((e,t)=>{var n=$("#wordtempl").clone(!0);n[0].item=t,n.attr("id","word"+(e+1)),n.addClass("word"),n.html(t.q+"&nbsp;&nbsp;"+(t.phonetic?"/"+t.phonetic+"/":"")+"&nbsp;&nbsp;"+(t.explain1||"")+(t.explain2?" | ":"")+(t.explain2||"")+(t.explain3?" | ":"")+(t.explain3||"")+(t.explain4?" | ":"")+(t.explain4||"")+(t.explain5?" | ":"")+(t.explain5||"")),$("#words").append(n),n.show()}))}}}):$("#words .word").remove()})),$("#zh_subtitles").bind("touchstart",(function(e){var t;(log.info("#zh_subtitles.touchstart"),$(e.target).hasClass("font"))&&(t=e,_coordinates={clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY,pageX:t.changedTouches[0].pageX,pageY:t.changedTouches[0].pageY},C(_coordinates),e.preventDefault())})).bind("touchmove",(function(e){var t;$(e.target).hasClass("font")&&(t=e,_coordinates={clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY,pageX:t.changedTouches[0].pageX,pageY:t.changedTouches[0].pageY},E(_coordinates),e.preventDefault())})).bind("touchend",(function(e){var t;(log.info("#zh_subtitles.touchend"),$(e.target).hasClass("font"))&&(t=e,_coordinates={clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY,pageX:t.changedTouches[0].pageX,pageY:t.changedTouches[0].pageY},F(_coordinates),e.preventDefault())})),$("#startFn").bind("click",(function(){log.info("#startFn.click"),z(),$("#video").attr("controls",!1)})),$("#stopFn").bind("click",(function(){log.info("#stopFn.click"),Y(),$("#video").attr("controls",!1)})),$("#prevline").bind("click",(function(){log.info("#prevline.click"),I()})),$("#currline").bind("click",(function(){log.info("#nextline.click"),_()})),$("#nextline").bind("click",(function(){log.info("#nextline.click"),S()})),$("#gear").bind("touchstart",(function(e){log.info("#gear.touchstart");var t=e.targetTouches[0];this.startX=t.pageX,this.startY=t.pageY})).bind("touchmove",(function(t){var n=t.targetTouches[0];this.endX=n.pageX,this.endY=n.pageY;var i=this.endX-this.startX;this.endY,this.startY;log.debug("distanceX: "+i+" lastDist: "+this.lastDist),null!=this.lastDist&&null!=this.lastDist||(this.lastDist=i);var s=i-this.lastDist;this.lastDist=i;var r=parseInt(this.style.left.replace("px"))+s;r<=0&&r>=-4900&&(this.style.left=r+"px"),this.xx||(this.xx=0),this.xx=this.xx+s;var o=null;this.xx>30?(o=j,o++):this.xx<-30&&(o=j,o--),null!=o&&(o<1&&(o=h.currentwords.length),o>h.currentwords.length&&(o=1),e.dovideoshadow=1,Y(),M(o),this.xx=0),t.preventDefault()})).bind("touchend",(function(e){log.info("#gear.touchend"),this.lastDist=null,this.xx=0})),$("#replay").bind("click",(function(e){log.info("#replay.click"),$("#video")[0].load(),setTimeout((function(){$("#video")[0].muted=!1}),500)})),$("#hideBtn").bind("click",(function(e){log.info("#hideBtn.click"),$("#zh_subtitles").css("opacity"),1==$("#zh_subtitles").css("opacity")?($("#zh_subtitles").css("opacity",0),$("#hideBtn").text("显示")):($("#zh_subtitles").css("opacity",1),$("#hideBtn").text("隐藏"))})),$("#wholebtn").bind("click",(function(e){log.info("#wholebtn.click"),D()})),$("#searchbtn").bind("click",(function(e){log.info("#searchbtn.click"),A()})),$("#chDialog").bind("click",(function(e){log.info("#chDialog.click"),N()})),document.body.addEventListener("click",(function(){log.debug(event.target)})),$("#goPrevVideo").click((function(){log.info("#goPrevVideo.click"),Y(),o[a-1]&&(a--,n=o[a].no,t=o[a],localStorage.setItem("videosIndex",a),w(t))})),$("#goNextVideo").click((function(){log.info("#goNextVideo.click"),v()})),$("#word-in").bind("blur",(function(){""==this.value&&($("#wordsframe").hide(),$("#video").css("top",0),z())}))}();